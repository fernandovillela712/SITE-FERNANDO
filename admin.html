<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>FERNANDO VILLELA | Admin</title>
        <!-- PUT CUSTOM FONT HERE -->
    <style>
        body { font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; background: #000; color: #fff; margin: 0; padding: 20px; box-sizing: border-box; }
        .card { background: #111; padding: 2.5rem; border-radius: 16px; border: 1px solid #333; text-align: center; width: 100%; max-width: 450px; }
        
        .input-group { margin-bottom: 1.5rem; text-align: left; }
        label { display: block; margin-bottom: 0.5rem; font-size: 0.8rem; color: #888; text-transform: uppercase; letter-spacing: 1px; }
        input { width: 100%; padding: 0.8rem; background: #222; border: 1px solid #444; border-radius: 8px; color: #fff; box-sizing: border-box; outline: none; }
        input:focus { border-color: #fff; }

        button { background: #fff; color: #000; border: none; padding: 1rem 2rem; border-radius: 8px; font-weight: bold; cursor: pointer; transition: transform 0.1s, opacity 0.2s; width: 100%; }
        button:hover { opacity: 0.9; }
        button:active { transform: scale(0.98); }

        #url-display { margin-top: 2rem; max-height: 300px; overflow-y: auto; text-align: left; display: none; }
        .url-entry { background: #1a1a1a; padding: 10px; border-radius: 6px; margin-bottom: 8px; border: 1px solid #333; position: relative; }
        .url-text { font-family: monospace; font-size: 0.75rem; color: #aaa; word-break: break-all; display: block; margin-top: 4px; }
        .copy-btn { width: auto; padding: 4px 8px; font-size: 0.7rem; margin-top: 8px; background: #333; color: #fff; }
    </style>
</head>
<body>

    <div class="card">
        <h2>Portfolio Uploader</h2>
        
        <div class="input-group">
            <label for="project-name">Project Slug (Folder Name)</label>
            <input type="text" id="project-name" placeholder="e.g. kimura-sans" autocomplete="off">
        </div>

        <button id="upload_widget">Open Upload Widget</button>

        <div id="url-display">
            <label>Uploaded Assets:</label>
        </div>
    </div>

    <script src="https://upload-widget.cloudinary.com/latest/global/all.js" type="text/javascript"></script>

    <script type="text/javascript">
        const cloudName = "dr5dbkh91"; 
        const uploadPreset = "portfolio_bento"; 

        // Function to clean up folder names (lowercase, dashes instead of spaces)
        const slugify = (text) => {
            return text.toString().toLowerCase()
                .replace(/\s+/g, '-')           // Replace spaces with -
                .replace(/[^\w\-]+/g, '')       // Remove all non-word chars
                .replace(/\-\-+/g, '-')         // Replace multiple - with single -
                .replace(/^-+/, '')             // Trim - from start
                .replace(/-+$/, '');            // Trim - from end
        };

        const displayArea = document.getElementById("url-display");

        document.getElementById("upload_widget").addEventListener("click", () => {
        const rawName = document.getElementById("project-name").value;
        const projectSlug = slugify(rawName) || "unsorted";
        const targetFolder = `projects/${projectSlug}`;

        cloudinary.openUploadWidget({
            cloudName: cloudName,
            uploadPreset: uploadPreset,
            folder: targetFolder, 
            resourceType: 'auto',
            sources: ['local', 'url'],
            multiple: true,
            maxFiles: 15,
            clientAllowedFormats: ['mp4', 'mov', 'png', 'jpg', 'jpeg'],
        }, (error, result) => {
            if (!error && result && result.event === "success") {
                displayArea.style.display = "block";
                
                const entry = document.createElement('div');
                entry.className = 'url-entry';
                const fileUrl = result.info.secure_url;
                
                entry.innerHTML = `
                    <strong style="font-size: 0.8rem">${result.info.original_filename}</strong>
                    <span class="url-text">${fileUrl}</span>
                    <button class="copy-btn" onclick="copyToClipboard('${fileUrl}', this)">Copy URL</button>
                `;
                displayArea.appendChild(entry);
            }
        });
    }, false);
    
        function copyToClipboard(text, btn) {
            navigator.clipboard.writeText(text).then(() => {
                const originalText = btn.innerText;
                btn.innerText = "Copied!";
                btn.style.background = "#28a745";
                setTimeout(() => {
                    btn.innerText = originalText;
                    btn.style.background = "#333";
                }, 2000);
            });
        }
    </script>
</body>
</html>